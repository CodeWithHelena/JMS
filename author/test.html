<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Modern Manuscript Cards</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            /* color variables - change here */
            --bg: #f7fafc;
            --card-bg: #ffffff;
            --primary: #ff7a18;
            /* accent (used for edit & primary accents) */
            --muted: #6b7280;
            /* grey text */
            --light-accent: #fff3e8;
            /* light background for status/button */
            --success: #10b981;
            --danger: #ef4444;
            --card-radius: 12px;
            --gap: 1rem;
            --card-border: rgba(16, 24, 40, 0.06);
            --max-width: 1200px;
        }

        body {
            background: var(--bg);
            color: #0f172a;
            font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            padding: 2rem 1rem;
        }

        .manuscripts-wrapper {
            max-width: var(--max-width);
            margin: 0 auto;
        }

        /* Grid: 3 columns desktop, 2 for <=991px, 1 for <=640px */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--gap);
        }

        @media (max-width: 991px) {
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
        }

        .manuscript-card {
            background: linear-gradient(180deg, var(--card-bg), var(--card-bg));
            border: 1px solid var(--card-border);
            border-radius: var(--card-radius);
            padding: 1rem;
            position: relative;
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.04);
            display: flex;
            flex-direction: column;
            min-height: 220px;
        }

        .card-header-row {
            display: flex;
            align-items: center;
            gap: .75rem;
            margin-bottom: .5rem;
        }

        .sidebar-logo {
            width: 56px;
            height: 56px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .sidebar-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block
        }

        .card-title {
            font-weight: 700;
            font-size: 1rem;
            line-height: 1.1;
            margin: 0;
            color: #081029;
        }

        .card-sub {
            font-size: .82rem;
            color: var(--muted);
            margin-top: .15rem;
        }

        /* Edit button (pill) */
        .btn-edit {
            position: absolute;
            top: 12px;
            right: 12px;
            background: transparent;
            border: none;
            color: var(--primary);
            display: inline-flex;
            align-items: center;
            gap: .45rem;
            padding: .35rem .6rem;
            font-weight: 600;
            border-radius: 999px;
            box-shadow: 0 4px 10px rgba(255, 122, 24, 0.08);
            transition: all .15s ease;
        }

        .btn-edit:hover {
            transform: translateY(-2px);
            background: rgba(255, 122, 24, 0.06);
        }

        .meta-row {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin: .45rem 0 1rem 0;
            flex-wrap: wrap
        }

        .meta {
            font-size: .82rem;
            color: var(--muted)
        }

        .status-badge {
            display: inline-block;
            padding: .28rem .5rem;
            font-weight: 700;
            font-size: .78rem;
            border-radius: 999px;
            background: var(--light-accent);
            color: var(--primary);
            box-shadow: inset 0 -4px 0 rgba(0, 0, 0, 0.02);
        }

        .card-actions {
            margin-top: auto;
            display: flex;
            gap: .6rem;
        }

        .btn-download {
            border-radius: 10px;
            border: 1px solid rgba(16, 24, 40, 0.06);
            padding: .45rem .8rem;
            background: transparent;
            font-weight: 600;
            display: inline-flex;
            gap: .6rem;
            align-items: center;
        }

        .btn-timeline {
            border-radius: 10px;
            padding: .45rem .8rem;
            background: transparent;
            border: 1px solid rgba(16, 24, 40, 0.09);
            display: inline-flex;
            gap: .6rem;
            align-items: center;
            font-weight: 600;
        }

        /* subtle small text under card */
        .submitted-text {
            font-size: .82rem;
            color: var(--muted);
            margin-top: .6rem;
        }

        /* Make small tweaks for better stacking on narrow cards */
        @media (max-width:420px) {
            .card-header-row {
                gap: .5rem
            }

            .card-actions {
                flex-direction: column;
                align-items: stretch
            }

            .btn-download,
            .btn-timeline {
                width: 100%
            }
        }
    </style>
</head>

<body>
    <div class="manuscripts-wrapper">
        <h2 class="mb-3">My Manuscripts</h2>

        <!-- Grid container where cards will be injected -->
        <div id="cardsGrid" class="cards-grid"></div>

        <!-- Template for fallback if JS disabled -->
        <noscript>
            <div class="alert alert-warning">JavaScript is required to load your manuscripts. Please enable JS.</div>
        </noscript>
    </div>

    <script>
        /*
          Example data shape expected from API. When you connect your real API,
          ensure it returns an array of objects with: id, title, journal, issn, authors, status, dateSubmitted, logo, downloadUrl
        */

        const sampleData = [
            {
                id: '1',
                title: 'New Manuscript for International Journal of Computing',
                journal: 'International Journal of Computing and Information Systems',
                issn: '2714-892X',
                authors: 'judith',
                status: 'submitted',
                dateSubmitted: '2025-11-28',
                logo: 'https://via.placeholder.com/240x160?text=Logo',
                downloadUrl: '#',
            },
            {
                id: '2',
                title: 'A Study on Modern Web Layouts',
                journal: 'Frontend Today',
                issn: '1234-5678',
                authors: 'Amarachi E.',
                status: 'under review',
                dateSubmitted: '2025-11-26',
                logo: 'https://via.placeholder.com/240x160?text=Logo+2',
                downloadUrl: '#'
            },
            {
                id: '3',
                title: 'Machine Learning in Document Processing',
                journal: 'AI & Data',
                issn: '9876-5432',
                authors: 'John Doe',
                status: 'accepted',
                dateSubmitted: '2025-10-10',
                logo: 'https://via.placeholder.com/240x160?text=AI',
                downloadUrl: '#'
            },
        ];

        const cardsGrid = document.getElementById('cardsGrid');

        function createCardMarkup(item) {
            const card = document.createElement('article');
            card.className = 'manuscript-card';
            card.innerHTML = `
        <button class="btn-edit" aria-label="Edit manuscript" onclick="onEdit('${item.id}')">
          <i class="fa fa-pencil"></i>
          <span class="d-none d-sm-inline">Edit</span>
        </button>

        <div class="card-header-row">
          <div class="sidebar-logo"><img src="${item.logo}" alt="logo"></div>
          <div style="flex:1; min-width:0">
            <h3 class="card-title">${escapeHtml(item.title)}</h3>
            <div class="card-sub">Journal: ${escapeHtml(item.journal)}</div>
          </div>
        </div>

        <div class="meta-row">
          <div class="meta"><strong>ISSN:</strong> ${escapeHtml(item.issn)}</div>
          <div class="meta"><strong>Authors:</strong> ${escapeHtml(item.authors)}</div>
          <div class="ms-auto"><span class="status-badge">${escapeHtml(item.status)}</span></div>
        </div>

        <div class="card-actions">
          <a class="btn-download" href="${item.downloadUrl}" title="Download">
            <i class="fa fa-download"></i> <span>Download</span>
          </a>

          <button class="btn-timeline" onclick="viewTimeline('${item.id}')">
            <i class="fa fa-eye"></i> <span>View Timeline</span>
          </button>
        </div>

        <div class="submitted-text">Submitted on ${escapeHtml(item.dateSubmitted)}</div>
      `;
            return card;
        }

        /* basic HTML escaping for safety */
        function escapeHtml(str) {
            if (!str && str !== 0) return '';
            return String(str)
                .replaceAll('&', '&amp;')
                .replaceAll('<', '&lt;')
                .replaceAll('>', '&gt;')
                .replaceAll('"', '&quot;')
                .replaceAll("'", '&#39;');
        }

        /* Example handlers */
        function onEdit(id) {
            // Replace with your real edit route
            window.location.href = `/author/edit-submission.html?id=${id}`;
        }
        function viewTimeline(id) {
            window.location.href = `/author/timeline.html?id=${id}`;
        }

        async function loadManuscripts() {
            // Replace this URL with your real API endpoint
            const API = '/api/manuscripts';
            try {
                const res = await fetch(API);
                if (!res.ok) throw new Error('Network response was not ok');
                const data = await res.json();
                // expect data to be an array
                return Array.isArray(data) ? data : [];
            } catch (err) {
                console.warn('Could not load from API, using sample data', err);
                return sampleData; // fallback so UI still shows
            }
        }

        (async () => {
            const items = await loadManuscripts();
            if (items.length === 0) {
                cardsGrid.innerHTML = '<div class="alert alert-info">No manuscripts found.</div>';
                return;
            }
            const fragment = document.createDocumentFragment();
            items.forEach(i => fragment.appendChild(createCardMarkup(i)));
            cardsGrid.appendChild(fragment);
        })();
    </script>
</body>

</html>